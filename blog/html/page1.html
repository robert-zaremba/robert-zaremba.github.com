<!DOCTYPE html>

<!--[if lt IE 7]>      <html 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml"
 class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml"
 class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml"
 class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml"
 class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Page 2 &mdash; Robert Zaremba Scale it blog</title><meta name="description" content="">
        <meta name="viewport" content="width=device-width">


        <link rel="stylesheet" href="_static/normalize.css" type="text/css">
        <link rel="stylesheet" href="_static/main.css" type="text/css">
        <link rel="stylesheet" href="_static/none" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
        <link rel="stylesheet" href="_static/webfont.css" type="text/css"><link rel="shortcut icon" href="_static/tinkerer.ico" /><!-- Load modernizr and JQuery -->
        <script src="_static/vendor/modernizr-2.6.2.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="_static/vendor/jquery-1.8.2.min.js"><\/script>')</script>
        <script src="_static/plugins.js"></script><link rel="top" title="Robert Zaremba Scale it blog" href="index.html" /><link rel="next" title="Older" href="page2.html" /><link rel="prev" title="Newer" href="index.html" /><link rel="alternate" type="application/rss+xml" title="RSS" href="rss.html" /><script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '#',
        VERSION:     '0.4.1b',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script><script type="text/javascript" src="_static/underscore.js"></script><script type="text/javascript" src="_static/doctools.js"></script><script type="text/javascript" src="_static/disqus.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            // Adjusts document height if sidebar is taller
            var documentwrapper = document.getElementsByTagName('article')[0];
            var sidebar = document.getElementsByTagName('aside')[0];

            if (sidebar.offsetHeight > documentwrapper.offsetHeight)
            {
                documentwrapper.style.minHeight = sidebar.offsetHeight + "px";
            }

            // Scroll to content if on small screen
            if (screen.width < 480)
            {
                $(document).scrollTop(documentwrapper.offsetTop - 44);
            }
        });
    </script>

    <meta property="og:title" content="Page 2 &mdash; Robert Zaremba Scale it blog" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="http://rz.scale-it.pl/page1.html" />
    <meta property="og:site_name" content="Robert Zaremba Scale it blog" />
    <meta property="fb:admins" content="1068985630" />
    <meta property="fb:app_id" content="544139755602282" />
    <!--     <meta property="og:description"
          content="some description"/> --></head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

      <div id="container"><div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/pl_PL/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-50c8b4e00796230b"></script> <!-- AddThis buttons -->

<div class="header-container">

    <header class="wrapper clearfix">
        <img id="logo" src="_static/logo1s.png" />
        <a href="https://github.com/robert-zaremba" id="github">View on GitHub</a> <div class="break" > </div>
        <a class="title" href="index.html">by Robert Zaremba</a>
        <nav class="clearfix">
          <div id="info">My space about information technology and programming</div>
          <div id="menu"><a href="rss.html" title="Subscribe via RSS" class="rss"><span class="webfont">B</span></a><a href="index.html">Home</a>
                <a href="pages/about_me.html">About me</a>
                <a href="http://scale-it.pl">Scale it</a>
              <a href="http://robert-zaremba.posterous.com/">My voyage [in polish]</a>
          </div>
        </nav>
    </header>
</div>

<div class="main-container"><div class="main wrapper clearfix"><article><ul class="related clearfix">
            <li class="left"> &laquo; <a href="index.html">Newer</a></li>
            <li class="right"><a href="page2.html">Older</a> &raquo; </li>
        </ul><div class="timestamp postmeta">
            <span>June 04, 2012</span>
        </div>
        <div class="section" id="hash-function-benchmark-in-python">
<h1><a href="2012/06/04/hash_function_benchmark_in_python.html">Hash function benchmark in python</a></h1>
<p>I got a task to process a documents which might change. So there need to be some worker process which crawl for processed documents, read new version and check the difference. I don’t want to get into details, but there was no point to store whole document, or some part of it to detect if document changed. If it changed it needs to be reprocessed from the beginning.</p>
<p>The simplest solution is to keep hash of the document, and than compare to hash of the new version. If it is different, than document was changed.</p>
<p>There are a lot of hash function. We can divide then into two groups:</p>
<ul class="simple">
<li>noncryptographic</li>
<li>cryptographic – we have additional requirement – having only hash result must be hard to find a document which hash equals result.</li>
</ul>
<p>Generally <em>noncryptographic</em> functions are faster.</p>
<p>The most well known hash functions are <strong>sha</strong> and <strong>md5</strong>. Since cryptographic wasn’t requirement, I look for others hash functions.</p>
<p>I don’t want to repeat some good texts about hash functions, so i point to two of them:</p>
<ul class="simple">
<li><a class="reference external" href="http://blog.aggregateknowledge.com/2011/12/05/choosing-a-good-hash-function-part-1/">Choosing a Good Hash Function</a></li>
<li><a class="reference external" href="http://burtleburtle.net/bob/hash/doobs.html">A Survey of Hash Functions</a></li>
</ul>
<p>I think, the best non-cryptographic hash function is <a class="reference external" href="http://code.google.com/p/smhasher/wiki/MurmurHash">MurmurHash</a> because:</p>
<ul class="simple">
<li>it’s darn fast</li>
<li>stable</li>
<li>used by others (Microsoft, Google)</li>
<li>great fraction of keys hashed without collision</li>
<li>has good avalanche behavior</li>
</ul>
<p>Here I present Python (2.7.3) and PyPy (1.8) performance test for some hash functions. The numbers are time execution of the test in seconds</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%"/>
<col width="31%"/>
<col width="38%"/>
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">method</th>
<th class="head">cpython</th>
<th class="head">pypy 1.8</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>md5</td>
<td>3.495</td>
<td>3.621</td>
</tr>
<tr class="row-odd"><td>mmh3</td>
<td>0.4336</td>
<td>6.186</td>
</tr>
<tr class="row-even"><td>smhasher</td>
<td>0.4417</td>
<td>5.877</td>
</tr>
<tr class="row-odd"><td>lookup3</td>
<td>1.6933</td>
<td>7.963</td>
</tr>
<tr class="row-even"><td>pyhash</td>
<td>0.00022</td>
<td>unsupported</td>
</tr>
</tbody>
</table>
<p>The test is very simple. It reads some html file (441KB) and just timeit for 4000 times:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">timeit</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">md5</span>
<span class="kn">import</span> <span class="nn">mmh3</span>     <span class="c"># http://pypi.python.org/pypi/mmh3/2.0</span>
<span class="kn">import</span> <span class="nn">smhasher</span> <span class="c"># http://pypi.python.org/pypi/smhasher</span>
<span class="kn">import</span> <span class="nn">pyhash</span>   <span class="c"># http://code.google.com/p/pyfasthash/</span>
                <span class="c"># need to install previously sudo apt-get install libboost-python-dev</span>
<span class="kn">import</span> <span class="nn">lookup3</span>

<span class="n">data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;ruya.html&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">num</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="n">repeat_n</span><span class="o">=</span><span class="mi">1</span>
<span class="n">setup_c</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">from hashlib import md5</span>
<span class="s">import mmh3</span>
<span class="s">import smhasher</span>
<span class="s">import lookup3</span>
<span class="s">#import pyhash</span>
<span class="s">data=open('ruya.html').read()</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="k">print</span> <span class="s">&quot;*&quot;</span><span class="o">*</span><span class="mi">40</span>
<span class="k">print</span> <span class="s">&quot;md5:&quot;</span><span class="p">,</span>  <span class="n">timeit</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">stmt</span><span class="o">=</span><span class="s">&quot;md5(data).digest()&quot;</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="n">setup_c</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="n">repeat_n</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="n">num</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;mmh3:&quot;</span><span class="p">,</span> <span class="n">timeit</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">stmt</span><span class="o">=</span><span class="s">&quot;mmh3.hash_bytes(data)&quot;</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="n">setup_c</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="n">repeat_n</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="n">num</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;smhasher&quot;</span><span class="p">,</span>  <span class="n">timeit</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">stmt</span><span class="o">=</span><span class="s">&quot;smhasher.murmur3_x64_128(data)&quot;</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="n">setup_c</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="n">num</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;lookup3&quot;</span><span class="p">,</span>  <span class="n">timeit</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">stmt</span><span class="o">=</span><span class="s">&quot;lookup3.hashlittle(data)&quot;</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="n">setup_c</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="n">num</span><span class="p">)</span>
</pre></div>
</div>
</div>
        <div class="postmeta"><div class="author">
            <span>Posted by Robert Zaremba</span>
        </div>
        <div class="categories">
            <span>
                Filed under:
                <a href="categories/computer_science.html">computer science</a></span>
        </div>
        <div class="tags">
            <span>
                Tags:
                <a href="tags/pypy.html">PyPy</a>, <a href="tags/python.html">Python</a>, <a href="tags/hash_function.html">hash-function</a>, <a href="tags/murmurhash.html">murmurhash</a></span>
        </div><div class="social-share">
	  <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://rz.scale-it.pl/2012/06/04/hash_function_benchmark_in_python.html">Tweet</a>
	  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

	  <script src="//platform.linkedin.com/in.js" type="text/javascript"></script>
	  <script type="IN/Share" data-url="http://rz.scale-it.pl/2012/06/04/hash_function_benchmark_in_python.html" data-counter="right"></script>

	  <span class="fb-like" data-send="true" data-width="250" data-show-faces="false" data-colorschme="dark" ></span>

	  <!-- AddThis Button BEGIN -->
	  <a class="addthis_button" id="addthis_button_5"
	     href="http://www.addthis.com/bookmark.php?v=300&amp;pubid=ra-50c8b4e00796230b">
	    <img src="http://s7.addthis.com/static/btn/v2/lg-share-en.gif" width="125" height="16" alt="Bookmark and Share" /></a>
	  <script type="text/javascript">
	     addthis.button('#addthis_button_5',
			    {"data_track_addressbar":true, "services_compact": "reddit,email,favorites,digg,wykop"},
			    {"url":"http://rz.scale-it.pl/2012/06/04/hash_function_benchmark_in_python.html", "title": "Interesting post: Hash function benchmark in python"});
	  </script>
	  <!-- AddThis Button END -->

	</div><div class="comments">
            <a href="http://rz.scale-it.pl/2012/06/04/hash_function_benchmark_in_python.html#disqus_thread" data-disqus-identifier="2012/06/04/hash_function_benchmark_in_python">Leave a comment</a>
        </div>
    </div><div class="separator post_separator"></div><div class="timestamp postmeta">
            <span>May 13, 2012</span>
        </div>
        <div class="section" id="scala-posts-on-scala-net-pl">
<h1><a href="2012/05/13/scala_posts_on_scala_net_pl.html">Scala posts on scala.net.pl</a></h1>
<p>Hi,</p>
<p>Recently I’m posting some articles about Scala programming language at <a class="reference external" href="http://scala.net.pl/">scala.net.pl</a>. It is in polish language. But someone might find it interesting.</p>
<p>My posts are reachable with: <a class="reference external" href="http://scala.net.pl/author/robert-zaremba/">http://scala.net.pl/author/robert-zaremba/</a></p>
</div>
        <div class="postmeta"><div class="author">
            <span>Posted by Robert Zaremba</span>
        </div>
        
        <div class="social-share">
	  <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://rz.scale-it.pl/2012/05/13/scala_posts_on_scala_net_pl.html">Tweet</a>
	  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

	  <script src="//platform.linkedin.com/in.js" type="text/javascript"></script>
	  <script type="IN/Share" data-url="http://rz.scale-it.pl/2012/05/13/scala_posts_on_scala_net_pl.html" data-counter="right"></script>

	  <span class="fb-like" data-send="true" data-width="250" data-show-faces="false" data-colorschme="dark" ></span>

	  <!-- AddThis Button BEGIN -->
	  <a class="addthis_button" id="addthis_button_4"
	     href="http://www.addthis.com/bookmark.php?v=300&amp;pubid=ra-50c8b4e00796230b">
	    <img src="http://s7.addthis.com/static/btn/v2/lg-share-en.gif" width="125" height="16" alt="Bookmark and Share" /></a>
	  <script type="text/javascript">
	     addthis.button('#addthis_button_4',
			    {"data_track_addressbar":true, "services_compact": "reddit,email,favorites,digg,wykop"},
			    {"url":"http://rz.scale-it.pl/2012/05/13/scala_posts_on_scala_net_pl.html", "title": "Interesting post: Scala posts on scala.net.pl"});
	  </script>
	  <!-- AddThis Button END -->

	</div><div class="comments">
            <a href="http://rz.scale-it.pl/2012/05/13/scala_posts_on_scala_net_pl.html#disqus_thread" data-disqus-identifier="2012/05/13/scala_posts_on_scala_net_pl">Leave a comment</a>
        </div>
    </div><div class="archive_link">
        <a href="archive.html"> &mdash;  Blog Archive  &mdash; </a>
    </div><ul class="related clearfix">
            <li class="left"> &laquo; <a href="index.html">Newer</a></li>
            <li class="right"><a href="page2.html">Older</a> &raquo; </li>
        </ul></article><aside><section><div class="widget clearfix" id="sidebar-me">
  <img src="_static/avatar.jpg" />
  Computer scientist, Python programmer, physics enthusiast<br />
  <a href="http://pl.linkedin.com/in/zarembarobert">
    <img src="http://www.linkedin.com/img/webpromo/btn_viewmy_160x25.png" height="25" alt="View Robert Zaremba's profile on LinkedIn" width="160" style="margin-top:12px" />
    </a>
</div></section><section><div class="widget">
    <h3>Recent Posts</h3>
    <ul><li>
            <a href="2012/12/10/blog_moved.html">Blog moved</a>
        </li><li>
            <a href="2012/11/16/keep_your_session_open.html">Keep your session open</a>
        </li><li>
            <a href="2012/06/04/hash_function_benchmark_in_python.html">Hash function benchmark in python</a>
        </li><li>
            <a href="2012/05/13/scala_posts_on_scala_net_pl.html">Scala posts on scala.net.pl</a>
        </li><li>
            <a href="2012/01/27/actor_and_functional_thinking_in_contrast_to_imperative_one.html">Actor and functional thinking in contrast to imperative one</a>
        </li><li>
            <a href="2012/01/09/jabber_client_behind_firewall_and_proxy.html">Jabber client behind firewall and proxy</a>
        </li><li>
            <a href="2012/01/02/how_to_add_gps__geolocation__tags_to_photos.html">How to add GPS (geolocation) tags to photos</a>
        </li></ul>
</div>
</section><section><div class="widget" id="searchbox">
    <h3>Search</h3>
    <form action="search.html" method="get">
        <input type="text" name="q" />
        <button type="submit"><span class="webfont">L</span></button>
    </form>
</div></section><section><div class="widget">
    <h3>Tags</h3><a href="tags/geolocation.html">geolocation</a> (1), <a href="tags/hash_function.html">hash-function</a> (1), <a href="tags/jabber.html">jabber</a> (1), <a href="tags/murmurhash.html">murmurhash</a> (1), <a href="tags/proxy.html">proxy</a> (1), <a href="tags/pypy.html">PyPy</a> (1), <a href="tags/python.html">Python</a> (1), <a href="tags/screen.html">screen</a> (1), <a href="tags/tmux.html">tmux</a> (1)</div></section></aside></div> <!-- #main --></div> <!-- #main-container -->

        <div class="footer-container"><footer class="wrapper">&copy; Copyright 2012, Robert Zaremba. Powered by <a href="http://www.tinkerer.me/">Tinkerer</a> and <a href="http://sphinx.pocoo.org/">Sphinx</a>.</footer></div> <!-- fotter-container -->

      </div> <!--! end of #container --><script type="text/javascript">    var disqus_shortname = "rz-scaleit";    disqus_count();</script><!--[if lt IE 7 ]>
          <script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
          <script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
        <![endif]-->
    </body>
</html>